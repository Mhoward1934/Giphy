<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <link rel="stylesheet" href="">
    <title>Giphy</title>
</head>

<body>
    <h1>Get GIPHY With It!</h1>
    <style type="text/css">
        button,
        div,
        form,
        input {
            margin: 10px;
        }
    </style>

    <body>

        <div class="container">
            <h2>Giphy Search for Reactions:</h2>

            <div id="laughs"></div>

            <form id="giphy-form">
                <label for="giphy-input">Add More Giphys!</label>
                <input type="text" id="giphy-input"><br>
                <input id="add-giphy" type="submit" value="Add More Giphys!">
            </form>

            <!-- Giphys will be placed here -->
            <div id="laughs-view"></div>

            <script src="https://code.jquery.com/jquery-3.3.1.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8="
                crossorigin="anonymous"></script>
                <script type="text/javascript">

                // Initial array of giphys
                var topics = ["funny", "whatever", "laughing"];

                //Display GiphyInfo function re-render the HTML to display the appropriate content
                function displayGiphyInfo() {
                    var topic = $(this).attr("data-name");
                    var queryURL = "https://api.giphy.com/v1/gifs/search?q=" + topic + "&api_key=V2w984oZdTWn5V7V54Zc4fLwoy2kkM6u&limit=10&rating=G";

                    //Created AJAX to call for the specfic giphy
                    $.ajax({
                        url: queryURL,
                        method: "GET"
                    }).then(function (response) {
                        console.log(response);
                        for (var i = 0; i < response.data.length; i++) {
                            giphy = topic[i];

                            //Creating the div to hold the giphy
                            var topicDiv = $("<div class='topic'>");

                            //Store the rating data
                            var rating = response.data[i].rating;

                            //Create an element to have the rating displayed
                            var pOne = $("<p>").text("Rating: " + rating);

                            //Displaying the rating
                            topicDiv.append(pOne);

                            //Getting the giphy image
                            var imgURL = response.data[i].images.original.url;

                            // Creating an element to hold the image
                            var images = $("<img>").attr("src", imgURL);

                            // Appending the image
                            topicDiv.append(images);

                            //Putting giphys in the html
                            $("#laughs-view").append(topicDiv);
                        }
                    });
                }

                // Function for displaying giphy data
                function renderButtons() {

                    // Deleting the giphy buttons prior to adding new giphy buttons
                    // (this is necessary otherwise we will have repeat buttons)
                    $("#laughs").empty();

                    // Looping through the array of giphys
                    for (var i = 0; i < topics.length; i++) {

                        // Then dynamicaly generating buttons for each topic in the array.
                        // This code $("<button>") is all jQuery needs to create the start and end tag. (<button></button>)
                        var a = $("<button>");
                        // Adding a class
                        a.addClass("giphy");
                        // Adding a data-attribute with a value of the topics at index i
                        a.attr("data-name", topics[i]);
                        // Providing the button's text with a value of the topics at index i
                        a.text(topics[i]);
                        // Adding the button to the HTML
                        $("#laughs").append(a);
                    }
                }
                // This function handles events where one button is clicked
                $("#add-giphy").on("click", function (event) {
                    // event.preventDefault() prevents the form from trying to submit itself.
                    event.preventDefault();

                    // This line will grab the text from the input box
                    var topic = $("#giphy-input").val().trim();
                    // The topic from the textbox is then added to the array
                    topics.push(topic);

                    // calling renderButtons which handles the processing of our topics array
                    renderButtons();
                });

                // Adding a click event listener to all elements with a class of "giphy-btn"
                $(document).on("click", ".giphy", displayGiphyInfo);

                // Calling the renderButtons function at least once to display the initial list of topics
                renderButtons();

            </script>

        </div>

    </body>

</html>